var WidgetType,Languages,__assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function __awaiter(e,a,s,c){return new(s=s||Promise)(function(t,n){function r(e){try{i(c.next(e))}catch(e){n(e)}}function o(e){try{i(c.throw(e))}catch(e){n(e)}}function i(e){var n;e.done?t(e.value):((n=e.value)instanceof s?n:new s(function(e){e(n)})).then(r,o)}i((c=c.apply(e,a||[])).next())})}function __generator(t,r){var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=r.call(t,s)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}}!function(e){e.Register="register",e.Login="login",e.Link="link",e.Recover="recover"}(WidgetType=WidgetType||{}),function(e){e.en="en",e.enGB="en-GB",e.enUS="en-US",e.ru="ru",e.es="es"}(Languages=Languages||{});var OwnIDGigyaUILib=function(){function e(){var n=this;this.ownIDWidget=null,this.observer=new MutationObserver(function(){var e;return null===(e=n.ownIDWidget)||void 0===e?void 0:e.recalculatePosition()})}return e.prototype.getOwnIdWrapper=function(){var e=document.getElementById("ownid-wrapper");return e||((e=document.createElement("div")).id="ownid-wrapper",document.body.appendChild(e)),e},e.prototype.renderInlineRegisterWidget=function(){var e=document.querySelector('[data-gigya-name="password"]'),n=document.querySelector('[data-gigya-name="passwordRetype"]');this.ownIDWidget=window.ownid.render({type:WidgetType.Register,inline:{targetElement:e,additionalElements:[n],offset:[0,-10]},element:this.getOwnIdWrapper(),onError:function(e){console.warn("onError",e)}})},e.prototype.renderInlineLoginWidget=function(n){var e=document.querySelector('[data-gigya-name="password"]');this.ownIDWidget=window.ownid.render({type:WidgetType.Login,inline:{targetElement:e,offset:[0,-10]},element:this.getOwnIdWrapper(),onError:function(e){console.warn("onError",e)},onLogin:function(e){document.cookie="gac_"+window.gigya.thisScript.APIKey+"="+e.sessionInfo.cookieValue+"; path=/",window.gigya.accounts.getAccountInfo({callback:n})}})},e.prototype.destroyOwnIDWidget=function(){this.ownIDWidget&&(this.ownIDWidget.destroy(),this.ownIDWidget=null)},e.prototype.onAfterScreenLoad=function(e,n){var t=this;this.destroyOwnIDWidget(),this.observer.disconnect(),this.observer.observe(document.getElementById(e.currentScreen),{attributes:!0,childList:!0,subtree:!0}),"gigya-login-screen"===e.currentScreen&&this.renderInlineLoginWidget(n),"gigya-register-screen"===e.currentScreen&&this.renderInlineRegisterWidget(),document.getElementsByClassName("gigya-input-submit")[0].addEventListener("click",function(){var e,n;null!==(e=t.ownIDWidget)&&void 0!==e&&e.disabled||(n=window.ownid.generateOwnIDPassword(32),document.querySelector('[data-gigya-name="password"]').value=n,document.querySelector('[data-gigya-name="passwordRetype"]').value=n)})},e.prototype.onHide=function(){this.destroyOwnIDWidget(),this.observer.disconnect()},e.prototype.onSubmit=function(t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(e){switch(e.label){case 0:return this.ownIDWidget?[4,window.ownid.getOwnIDPayload(this.ownIDWidget)]:[3,2];case 1:(n=e.sent().data)&&(t.formModel.data.ownIdConnections=[__assign({},n)]),e.label=2;case 2:return[2,t]}})})},e}();window.ownid.gigya=window.ownid.gigya instanceof OwnIDGigyaUILib?window.ownid.gigya:new OwnIDGigyaUILib;
