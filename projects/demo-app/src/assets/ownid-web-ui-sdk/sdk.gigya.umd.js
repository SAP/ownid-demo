!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";var t,e,n,o=function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function r(e,a,c,d){return new(c=c||Promise)(function(t,n){function o(e){try{i(d.next(e))}catch(e){n(e)}}function r(e){try{i(d.throw(e))}catch(e){n(e)}}function i(e){var n;e.done?t(e.value):((n=e.value)instanceof c?n:new c(function(e){e(n)})).then(o,r)}i((d=d.apply(e,a||[])).next())})}function i(t,o){var r,i,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=o.call(t,c)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}}(e=t=t||{}).Register="register",e.Login="login",e.Link="link",e.Recover="recover",(n={}).en="en",n.enGB="en-GB",n.enUS="en-US",n.ru="ru",n.es="es";var a=(c.prototype.getOwnIdWrapper=function(){var e=document.getElementById("ownid-wrapper");return e||((e=document.createElement("div")).id="ownid-wrapper",document.body.appendChild(e)),e},c.prototype.renderInlineRegisterWidget=function(){var e=document.querySelector('[data-gigya-name="password"]'),n=document.querySelector('[data-gigya-name="passwordRetype"]');this.ownIDWidget=window.ownid.render({type:t.Register,inline:{targetElement:e,additionalElements:[n],offset:[0,-10]},element:this.getOwnIdWrapper(),onError:function(e){console.warn("onError",e)}})},c.prototype.renderInlineLoginWidget=function(n){var e=document.querySelector('[data-gigya-name="password"]');this.ownIDWidget=window.ownid.render({type:t.Login,inline:{targetElement:e,offset:[0,-10]},element:this.getOwnIdWrapper(),onError:function(e){console.warn("onError",e)},onLogin:function(e){document.cookie="gac_"+window.gigya.thisScript.APIKey+"="+e.sessionInfo.cookieValue+"; path=/",window.gigya.accounts.getAccountInfo({callback:n})}})},c.prototype.destroyOwnIDWidget=function(){this.ownIDWidget&&(this.ownIDWidget.destroy(),this.ownIDWidget=null)},c.prototype.onAfterScreenLoad=function(e,n){var t=this;this.destroyOwnIDWidget(),this.observer.disconnect(),this.observer.observe(document.getElementById(e.currentScreen),{attributes:!0,childList:!0,subtree:!0}),"gigya-login-screen"===e.currentScreen&&this.renderInlineLoginWidget(n),"gigya-register-screen"===e.currentScreen&&this.renderInlineRegisterWidget(),document.getElementsByClassName("gigya-input-submit")[0].addEventListener("click",function(){var e,n;null!==(e=t.ownIDWidget)&&void 0!==e&&e.disabled||(n=window.ownid.generateOwnIDPassword(32),document.querySelector('[data-gigya-name="password"]').value=n,document.querySelector('[data-gigya-name="passwordRetype"]').value=n)})},c.prototype.onHide=function(){this.destroyOwnIDWidget(),this.observer.disconnect()},c.prototype.onSubmit=function(t){return r(this,void 0,void 0,function(){var n;return i(this,function(e){switch(e.label){case 0:return this.ownIDWidget?[4,window.ownid.getOwnIDPayload(this.ownIDWidget)]:[3,2];case 1:(n=e.sent().data)&&(t.formModel.data.ownIdConnections=[o({},n)]),e.label=2;case 2:return[2,t]}})})},c);function c(){var n=this;this.ownIDWidget=null,this.observer=new MutationObserver(function(){var e;return null===(e=n.ownIDWidget)||void 0===e?void 0:e.recalculatePosition()})}window.ownid.gigya=window.ownid.gigya instanceof a?window.ownid.gigya:new a});
